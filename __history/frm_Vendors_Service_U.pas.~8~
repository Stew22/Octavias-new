unit frm_Vendors_Service_U;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls, Vcl.Menus,
  System.ImageList, Vcl.ImgList,DM_Vendors;

type
  Tfrmaddservice = class(TForm)
    il1: TImageList;
    mm1: TMainMenu;
    Fiel1: TMenuItem;
    AddVendor1: TMenuItem;
    AddVendor2: TMenuItem;
    DeleteVendor1: TMenuItem;
    N1: TMenuItem;
    N2: TMenuItem;
    N3: TMenuItem;
    N4: TMenuItem;
    Help1: TMenuItem;
    pnl1: TPanel;
    pnl2: TPanel;
    edtvendorname: TEdit;
    edtvscode: TEdit;
    edtvcname: TEdit;
    edtvsaddress: TEdit;
    edtvsemail: TEdit;
    cbbvservicet: TComboBox;
    lbl1: TLabel;
    lbl2: TLabel;
    lbl3: TLabel;
    lbl4: TLabel;
    lbl5: TLabel;
    lbl6: TLabel;
    edtvsphone: TEdit;
    lbl7: TLabel;
    btnaddvendor: TButton;
    btnclear: TButton;
    btncancel: TButton;
    lbl8: TLabel;
    procedure btncancelClick(Sender: TObject);
    procedure btnaddvendorClick(Sender: TObject);
    procedure FormActivate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmaddservice: Tfrmaddservice;

implementation

{$R *.dfm}

procedure Tfrmaddservice.btnaddvendorClick(Sender: TObject);
begin
 // here we will add service vendors
end;

procedure Tfrmaddservice.btncancelClick(Sender: TObject);
begin
 //here we will clear all forms and exit the form
 edtvendorname.Clear;
 edtvscode.Clear;
 edtvendorname.Clear;
 edtvsaddress.Clear;
 edtvsemail.Clear;
 edtvsphone.Clear;
 cbbvservicet.Clear;
 //
 frmaddservice.Close;
end;

procedure Tfrmaddservice.FormActivate(Sender: TObject);
begin
  with Datamodulevendor do
  begin
    if not convendor.Connected then
    begin
      // Connect to the database
      convendor.ConnectionString := 'Provider=Microsoft.ACE.OLEDB.12.0;' +
        'Data Source=' + ExtractFilePath(Application.ExeName) + '\Bin\Vendor_Database.accdb' +
        ';Mode=ReadWrite;Persist Security Info=False';
      //
      tblvendor.TableName := 'tblvendors';
      convendor.Connected := True;
      tblvendor.Active := True;
      tblvendor.First;
      // Populate user fields or any other necessary initializations
    end;
  end;
end;

end.
