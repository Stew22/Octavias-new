unit frm_Bulk_Pricing_Update_U;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Menus, Vcl.ExtCtrls, Vcl.StdCtrls,
  System.ImageList, Vcl.ImgList, Vcl.Imaging.pngimage,DM_Products;

type
  Tfrmblkpricingupdate = class(TForm)
    pnl1: TPanel;
    mm1: TMainMenu;
    File1: TMenuItem;
    GetTemplate1: TMenuItem;
    GetTemplate2: TMenuItem;
    UpdatePricing1: TMenuItem;
    UpdatePricing2: TMenuItem;
    Exit1: TMenuItem;
    Exit2: TMenuItem;
    N1: TMenuItem;
    N3: TMenuItem;
    N4: TMenuItem;
    N5: TMenuItem;
    N6: TMenuItem;
    N7: TMenuItem;
    pnl2: TPanel;
    il1: TImageList;
    cbbvendorselect: TComboBox;
    lbl1: TLabel;
    pnl3: TPanel;
    btngenerateexport: TButton;
    btncheckimport: TButton;
    btnupdatepricing: TButton;
    btncancel: TButton;
    btnexit: TButton;
    mmooutput: TMemo;
    lbl2: TLabel;
    lbl4: TLabel;
    lbl3: TLabel;
    procedure GetTemplate1Click(Sender: TObject);
    procedure GetTemplate2Click(Sender: TObject);
    procedure UpdatePricing1Click(Sender: TObject);
    procedure UpdatePricing2Click(Sender: TObject);
    procedure Exit1Click(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure cbbvendorselectChange(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmblkpricingupdate: Tfrmblkpricingupdate;

implementation

{$R *.dfm}

procedure Tfrmblkpricingupdate.cbbvendorselectChange(Sender: TObject);
begin
 //here we are going to set a filter so only export vendors items
 //
 mmooutput.Lines.Add('Bulk Update Form Has Been Opened');
end;

procedure Tfrmblkpricingupdate.Exit1Click(Sender: TObject);
begin
 btnexit.Click;
end;

procedure Tfrmblkpricingupdate.FormShow(Sender: TObject);
var
 Tname:TStrings;
begin
 with DataModuleProducts do
 begin
   if tblproducts.Active = True then
   begin
    //here we are going to populate the combo box with a list of vendors from the
    //products database so we can update pricing
    //
    cbbvendorselect.Clear;
    //
    Tname := TStringList.Create;
    try
     tblproducts.First;
     //
     while not tblproducts.Eof do
     begin
      if Tname.IndexOf(tblproducts.FieldByName('Vendor_Name').AsString) = -1 then
      begin
       //add to the stringlist
       Tname.Add(tblproducts.FieldByName('Vendor_Name').AsString);
       tblproducts.Next;
      end else
      begin
       //record already exists , then we just move to the next record
       tblproducts.Next;
      end;
      //
      //assign the vlaues from the stringlist to the combobox
      cbbvendorselect.Items.Assign(Tname);
     end;
    finally
     Tname.Free;
    end;
   end else
   begin
    ShowMessage('There Was An Error Connecting To The Products Database , Please Contact Your Software Developer');
   end;
 end;
end;

procedure Tfrmblkpricingupdate.GetTemplate1Click(Sender: TObject);
begin
 btngenerateexport.Click;
end;

procedure Tfrmblkpricingupdate.GetTemplate2Click(Sender: TObject);
begin
 btncheckimport.Click;
end;

procedure Tfrmblkpricingupdate.UpdatePricing1Click(Sender: TObject);
begin
 btnupdatepricing.Click;
end;

procedure Tfrmblkpricingupdate.UpdatePricing2Click(Sender: TObject);
begin
 btncancel.Click;
end;

end.
